---
layout: default
title: 分类
---
<div class="category-single" id="category-page">
  <noscript>
    <div class="no-js-message">
      <p>请启用 JavaScript 查看分类页面，或访问 <a href="/categories/">分类列表</a></p>
    </div>
  </noscript>
</div>

<script>
(function() {
  // Get category name from URL path (e.g., /category/AI开发 -> AI开发)
  const pathParts = window.location.pathname.split('/').filter(Boolean);
  const categoryName = pathParts[pathParts.length - 1];

  // Category data from all posts
  const categoryData = {
    {% for category in site.categories %}
    "{{ category[0] }}": [
      {% for post in category[1] %}
      {
        title: "{{ post.title | escape }}",
        url: "{{ post.url | relative_url }}",
        date: "{{ post.date | date: "%Y-%m-%d" }}",
        tags: [{% for tag in post.tags %}"{{ tag }}"{% unless forloop.last %},{% endunless %}{% endfor %}],
        excerpt: {{ post.content | strip_html | truncatewords: 80 | strip_newlines | jsonify }},
        og_image: {% if post.og_image %}"{{ post.og_image | relative_url }}"{% else %}null{% endif %}
      }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ]{% unless forloop.last %},{% endunless %}
    {% endfor %}
  };

  const posts = categoryData[categoryName] || [];

  const container = document.getElementById('category-page');

  if (posts.length === 0) {
    container.innerHTML = `
      <h2>分类: ${decodeURIComponent(categoryName)}</h2>
      <p class="category-info">该分类下还没有文章。</p>
      <p class="back-link"><a href="/categories/">&larr; 返回分类列表</a></p>
    `;
  } else {
    let postsHtml = `
      <h2>分类: ${decodeURIComponent(categoryName)}</h2>
      <p class="category-info">共 ${posts.length} 篇文章</p>
      <div class="posts-list">
    `;

    posts.forEach(post => {
      const tagsHtml = post.tags.length > 0
        ? `<span class="post-tags-list">${post.tags.map(t => `<a href="/tag/${encodeURIComponent(t)}" class="post-tag-item">#${t}</a>`).join('')}</span>`
        : '';

      const imageHtml = post.og_image
        ? `<a href="${post.url}"><img src="${post.og_image}" alt="${post.title}" class="post-preview-thumbnail"></a>`
        : '';

      postsHtml += `
        <article class="post-preview">
          <h3 class="post-title"><a href="${post.url}">${post.title}</a></h3>
          <div class="post-meta">
            <time datetime="${post.date}">${post.date}</time>
            ${tagsHtml}
          </div>
          <div class="post-preview-body">
            ${imageHtml}
            <div class="post-preview-excerpt">
              <div class="post-excerpt">${post.excerpt}</div>
            </div>
          </div>
        </article>
      `;
    });

    postsHtml += `
      </div>
      <p class="back-link"><a href="/categories/">&larr; 返回分类列表</a></p>
    `;

    container.innerHTML = postsHtml;
  }
})();
</script>
